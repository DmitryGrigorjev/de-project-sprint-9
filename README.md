# Проект 9-го спринта

### Как работать с репозиторием
1. В вашем GitHub-аккаунте автоматически создастся репозиторий `de-project-sprint-9` после того, как вы привяжете свой GitHub-аккаунт на Платформе.
2. Скопируйте репозиторий на свой компьютер. В качестве пароля укажите ваш `Access Token`, который нужно получить на странице [Personal Access Tokens](https://github.com/settings/tokens)):
	* `git clone https://github.com/{{ username }}/de-project-sprint-9.git`
3. Перейдите в директорию с проектом: 
	* `cd de-project-sprint-9`
4. Выполните проект и сохраните получившийся код в локальном репозитории:
	* `git add .`
	* `git commit -m 'my best commit'`
5. Обновите репозиторий в вашем GitHub-аккаунте:
	* `git push origin main`
	
### Выполнение проекта
# DDS слой 

1. Не очень понятно написано в задании, но насколько я понял - данные из брокера уже лежат в stg слое после выполнения заданий спринта, за одним исключением -
	как и говорилось в ходе спринта названия ресторана нет, только uuid. Поэтому в ходе проекта будем обогащать данные в dds 
	слое из редиса (где кстати из всех данных всего один ресторан) и разносить
	по таблицам dds слоя разбирая json из поля paylod в таблице stg слоя (а не забирать все и обогащать из kafka). Скриншоты данных - redis.png и stg_postgre.png.
	
##### ок, создал два топика dds-service-orders и cdm-service-orders
1. "Если я правильно понимаю, то слой DDS выполняет в том числе функции STG? Согласно архитектуре, слой STG должен читать данные из Redis и из второго источника, 
	а затем их обогащать и направлять в топик, который потом будет читать DDS. "
	нет, не так. это я немного запутался. из редиса мы просто берем данные и через топик dds-service-orders разносим его по dds слою. из postgre (где у нас уже есть
	stg слой) мы также просто читаем данные и разносим их в dds слой (можно наоборот сделать, сначала постгри, потом редис). все это делается через один топик последовательно.
	А читать данные из dds схем потом будем для витрин и направлять их в cdm топик, если я правильно понял архитектуру. 

2. Запушено в yandex-cloud - cr.yandex/crp1ihf9a8emk9sn50du/dds_service:v2023-02-20-r3

# CDM слой

1. Только отправил второй релиз и сразу же понял что забыл про cdm слой в кафку. Сначала мы считываем из dds слоя агрегированные данные, 
	направляем в топик cdm-service-orders, затем считываем из него сообщения и записываем первую витрину методами класса PgConnect.
   Вторую витрину мы также считываем из DDS, стираем записываем (именно в таком порядке, чтобы заранее не стереть ее если вдруг будут проблемы со считываем из DDS),
   и делаем это через тот же топик, т.е. витрины обновляются последовательно.
   
2. аналогично - cr.yandex/crp1ihf9a8emk9sn50du/cdm_service:v2023-02-20-r3

######### Перенес чтение данных в DDS слой и направил их в топик cdm-service-orders :)
cr.yandex/crp1ihf9a8emk9sn50du/dds_service:v2023-02-21-r4
cr.yandex/crp1ihf9a8emk9sn50du/cdm_service:v2023-02-21-r4

